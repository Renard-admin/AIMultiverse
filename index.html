<!DOCTYPE html>
<html lang="ru" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Multiverse | Premium Motion Design</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@300;900&family=Playfair+Display:ital,wght@1,900&family=Inter:wght@300;400;500;600;800&family=Bodoni+Moda:ital,wght@1,900&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #c5a368;
            --bg: #050505;
            --text: #f1f5f9;
            --card-bg: rgba(255, 255, 255, 0.02);
            --font-main: 'Inter', sans-serif;
            --font-accent: 'Inter', sans-serif;
            --bezier: cubic-bezier(0.16, 1, 0.3, 1);
            --card-radius: 12px;
        }

        /* --- ГЛУБОКАЯ ПРОРАБОТКА ПАЛИТР --- */
        .style-pro { 
            --accent: #c5a368; 
            --bg: #050505; 
            --text: #e2e8f0;
            --font-accent: 'Inter', sans-serif; 
            --card-radius: 2px;
        }
        .style-picasso { 
            --accent: #d97706; 
            --bg: #0c0c0e; 
            --text: #fef3c7;
            --font-accent: 'Unbounded', sans-serif; 
            --card-radius: 0px;
            --card-bg: rgba(217, 119, 6, 0.03);
        }
        .style-vangogh { 
            --accent: #facc15; 
            --bg: #0a0f1d; 
            --text: #f0f9ff;
            --font-accent: 'Playfair Display', serif; 
            --card-radius: 50px;
            --card-bg: rgba(250, 204, 21, 0.02);
        }
        .style-whiskey { 
            --accent: #f59e0b; 
            --bg: #0a0805; 
            --text: #ffedd5;
            --font-accent: 'Bodoni Moda', serif; 
            --card-bg: rgba(245, 158, 11, 0.04); 
            --card-radius: 24px;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: var(--font-main);
            transition: background-color 1.2s var(--bezier);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        /* Настройка курсора */
        @media (hover: hover) and (pointer: fine) {
            body { cursor: none; }
            #cursor-ui { display: block; }
        }
        @media (hover: none), (pointer: coarse) {
            #cursor-ui { display: none; }
            body { cursor: auto; }
        }

        .accent-font { font-family: var(--font-accent); }

        /* --- Custom Thick Venom Cursor --- */
        #cursor-ui {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 10000;
        }

        .gooey-layer {
            filter: url('#goo-cursor');
        }

        .cursor-blob {
            position: absolute;
            background: var(--accent);
            border-radius: 50%;
            will-change: transform;
            transition: background-color 0.5s var(--bezier);
            box-shadow: inset 0 0 10px rgba(255,255,255,0.2);
        }

        #cursor-main { width: 42px; height: 42px; z-index: 2; }
        #cursor-trail { width: 34px; height: 34px; opacity: 0.7; z-index: 1; }
        #cursor-dot {
            position: absolute;
            width: 6px; height: 6px;
            background: #fff;
            border-radius: 50%;
            z-index: 3;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 10px var(--accent);
        }

        /* --- Navigation Slime (FIXED VISIBILITY) --- */
        .nav-container {
            position: relative;
            background: rgba(255, 255, 255, 0.03);
            padding: 4px;
            border-radius: 999px;
            display: flex;
            border: 1px solid rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
        }

        .nav-slime-layer {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            filter: url('#goo-nav');
            pointer-events: none;
            z-index: 1;
        }

        .nav-liquid-bg {
            position: absolute;
            background: var(--accent);
            border-radius: 999px;
            transition: all 0.6s var(--bezier);
            box-shadow: 0 0 40px var(--accent);
            height: calc(100% - 12px);
            top: 6px;
            width: 0;
        }

        .nav-btn {
            position: relative;
            z-index: 10;
            padding: 10px 24px;
            font-size: 10px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: rgba(255, 255, 255, 0.5);
            transition: color 0.4s var(--bezier), transform 0.3s var(--bezier);
            white-space: nowrap;
        }

        .nav-btn.active {
            color: #000;
            transform: scale(1.05);
        }

        #bg-canvas {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 0; opacity: 0.4;
        }

        /* --- UI Elements per Style --- */
        .magnetic { display: inline-block; transition: transform 0.6s var(--bezier); will-change: transform; }

        .model-card {
            background: var(--card-bg);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(255,255,255,0.06);
            border-radius: var(--card-radius);
            transition: transform 1s var(--bezier), border-color 0.4s ease, box-shadow 1s var(--bezier), opacity 1s var(--bezier);
            will-change: transform, opacity;
        }

        /* Picasso: Sharp & Asymmetric */
        .style-picasso .model-card { 
            clip-path: polygon(6% 0%, 100% 12%, 94% 100%, 0% 88%); 
            border-color: rgba(217, 119, 6, 0.1);
        }
        .style-picasso .nav-liquid-bg { filter: none; border-radius: 0; }

        /* Van Gogh: Flowing */
        .style-vangogh .model-card { 
            border-radius: 80px 20px 80px 20px / 20px 80px 20px 80px; 
            border: 2px solid rgba(250, 204, 21, 0.1); 
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        /* Whiskey: Luxury */
        .style-whiskey .model-card { 
            border: 1px solid rgba(255, 255, 255, 0.15); 
            box-shadow: inset 0 0 50px rgba(245, 158, 11, 0.05); 
        }

        .model-card:hover {
            border-color: var(--accent);
            transform: translateY(-20px) scale(1.05) rotate(0deg) !important;
            box-shadow: 0 60px 120px rgba(0,0,0,0.9);
            z-index: 20;
        }

        .glass-nav {
            backdrop-filter: blur(50px);
            background: rgba(0, 0, 0, 0.9);
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .reveal { opacity: 0; transform: translateY(40px); transition: opacity 1.2s var(--bezier), transform 1.2s var(--bezier); }
        .reveal.active { opacity: 1; transform: translateY(0); }

        #shutter {
            position: fixed; inset: 0; background: var(--accent); z-index: 9999;
            transform: scaleY(0); transform-origin: bottom; pointer-events: none;
        }
        .shutter-anim { animation: shutterSweep 1.2s var(--bezier); }
        @keyframes shutterSweep {
            0% { transform: scaleY(0); transform-origin: bottom; }
            50% { transform: scaleY(1); transform-origin: bottom; }
            51% { transform: scaleY(1); transform-origin: top; }
            100% { transform: scaleY(0); transform-origin: top; }
        }

        .copy-toast {
            position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%);
            background: var(--accent); color: black; padding: 0.8rem 2rem; font-size: 11px;
            font-weight: 900; text-transform: uppercase; border-radius: 4px; z-index: 10002;
            display: none; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--accent); }
    </style>
</head>
<body class="style-pro antialiased">

    <!-- Filters -->
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" style="display: none;">
      <defs>
        <filter id="goo-cursor">
          <feGaussianBlur in="SourceGraphic" stdDeviation="12" result="blur" />
          <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 35 -15" result="goo" />
          <feComposite in="SourceGraphic" in2="goo" operator="atop"/>
        </filter>
        <filter id="goo-nav">
          <feGaussianBlur in="SourceGraphic" stdDeviation="7" result="blur" />
          <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -8" result="goo" />
        </filter>
      </defs>
    </svg>

    <!-- Custom UI -->
    <div id="cursor-ui">
        <div class="gooey-layer">
            <div id="cursor-trail" class="cursor-blob"></div>
            <div id="cursor-main" class="cursor-blob"></div>
        </div>
        <div id="cursor-dot"></div>
    </div>

    <div id="shutter"></div>
    <div id="toast" class="copy-toast">Система: Данные в буфере</div>
    <canvas id="bg-canvas"></canvas>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-nav px-6 md:px-10 py-4 md:py-6 flex flex-col md:flex-row justify-between items-center gap-4">
        <div class="flex items-center gap-6">
            <span class="accent-font text-2xl md:text-3xl font-black uppercase tracking-tighter magnetic" id="site-logo">AI.Multiverse</span>
        </div>
        
        <div class="flex items-center gap-4 md:gap-10">
            <div class="nav-container">
                <div class="nav-slime-layer">
                    <div class="nav-liquid-bg" id="liquid-bg"></div>
                </div>
                <button onclick="changeStyle('pro')" class="nav-btn active" id="btn-pro">Pro</button>
                <button onclick="changeStyle('picasso')" class="nav-btn" id="btn-picasso">Picasso</button>
                <button onclick="changeStyle('vangogh')" class="nav-btn" id="btn-vangogh">Vincent</button>
                <button onclick="changeStyle('whiskey')" class="nav-btn" id="btn-whiskey">Whiskey</button>
            </div>
            
            <button onclick="toggleSettings()" class="magnetic p-3 bg-white/5 rounded-full hover:bg-white hover:text-black transition-all">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
        </div>
    </nav>

    <!-- Hero -->
    <section class="min-h-screen flex flex-col justify-center items-center text-center px-6 relative pt-32 overflow-hidden">
        <div class="reveal active">
            <h1 class="accent-font text-[14vw] md:text-[10vw] font-black leading-none mb-8 italic tracking-tighter" id="hero-title">The Core.</h1>
            <p class="max-w-3xl text-zinc-500 text-base md:text-2xl font-light mb-12 opacity-80 leading-relaxed" id="hero-desc">
                Ваша персональная точка доступа к глобальному интеллекту. 80+ моделей в четырех визуальных измерениях.
            </p>
            <button onclick="document.getElementById('gallery').scrollIntoView({behavior:'smooth'})" class="magnetic px-12 md:px-16 py-5 md:py-6 bg-white text-black font-black uppercase text-[11px] tracking-[0.4em] hover:bg-amber-500 transition-all shadow-2xl">
                Исследовать
            </button>
        </div>
    </section>

    <!-- Advisor -->
    <section id="advisor" class="py-24 md:py-48 px-6 md:px-8 max-w-7xl mx-auto reveal">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 md:gap-32 items-center">
            <div class="space-y-10 md:space-y-12">
                <h2 class="accent-font text-4xl md:text-7xl font-black mb-10 leading-tight md:leading-[0.85]">Consult <br><span id="display-asst-name" class="text-amber-500 italic">The Architect</span></h2>
                <p class="text-zinc-500 text-lg md:text-xl font-medium leading-relaxed">Опишите задачу. Мы спроектируем оптимальную стратегию и подберем стек нейросетей.</p>
                <textarea id="advisor-query" placeholder="Какую задачу мы решим сегодня?" class="w-full bg-white/5 border border-white/10 p-8 md:p-10 h-48 md:h-64 outline-none focus:border-amber-500 transition-all text-lg resize-none text-white font-medium rounded-xl"></textarea>
                <button onclick="runAdvisor()" id="advisor-btn" class="magnetic w-full py-6 md:py-7 bg-zinc-900 border border-zinc-800 text-white font-black uppercase text-[12px] tracking-[0.5em] hover:bg-white hover:text-black transition-all">Сгенерировать решение</button>
            </div>
            <div id="advisor-result" class="min-h-[400px] md:min-h-[600px] border border-white/5 p-8 md:p-16 flex flex-col justify-center bg-black/40 shadow-2xl relative rounded-3xl overflow-hidden">
                <div id="advisor-empty" class="text-center opacity-10">
                    <div class="mb-10 mx-auto w-24 h-24 border-4 border-dashed border-amber-500 rounded-full animate-spin-slow"></div>
                    <p class="uppercase tracking-[0.6em] text-sm font-bold">Ожидание запроса</p>
                </div>
                <div id="advisor-content" class="hidden space-y-12"></div>
            </div>
        </div>
    </section>

    <!-- Gallery -->
    <section id="gallery" class="py-24 md:py-40 px-6 md:px-8 max-w-[1900px] mx-auto">
        <div class="flex flex-col lg:flex-row justify-between items-start lg:items-end gap-12 mb-20 md:mb-40 reveal">
            <div class="w-full lg:w-2/3">
                <h3 class="accent-font text-5xl md:text-[10rem] font-black italic opacity-5 text-white mb-10 leading-none">The Archive</h3>
                <div class="flex flex-wrap gap-6 md:gap-12 text-[10px] md:text-[12px] font-black uppercase tracking-[0.3em] text-zinc-600" id="filter-bar">
                    <span onclick="setFilter('all')" class="cursor-pointer hover:text-amber-500 transition-all active-filter" data-cat="all">Все потоки</span>
                    <span onclick="setFilter('video')" class="cursor-pointer hover:text-amber-500 transition-all" data-cat="video">Видео</span>
                    <span onclick="setFilter('image')" class="cursor-pointer hover:text-amber-500 transition-all" data-cat="image">Визуал</span>
                    <span onclick="setFilter('audio')" class="cursor-pointer hover:text-amber-500 transition-all" data-cat="audio">Звук</span>
                    <span onclick="setFilter('llm')" class="cursor-pointer hover:text-amber-500 transition-all" data-cat="llm">Интеллект</span>
                </div>
            </div>
            <div class="w-full lg:w-1/3 flex flex-col items-start lg:items-end">
                <input type="text" id="search-input" oninput="handleSearch()" placeholder="Поиск инструментов..." class="w-full bg-transparent border-b-4 border-white/5 py-6 outline-none focus:border-amber-500 transition-all font-light text-2xl md:text-5xl text-white">
                <div id="tool-counter" class="text-[12px] uppercase tracking-widest text-zinc-700 mt-8 font-black">Синхронизировано: 0 моделей</div>
            </div>
        </div>
        <div id="grid-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-8 md:gap-12"></div>
    </section>

    <footer class="py-40 border-t border-white/5 text-center relative overflow-hidden px-6">
        <div class="accent-font text-6xl md:text-8xl font-black mb-12 text-white magnetic opacity-20">AI Multiverse</div>
        <p class="text-[12px] uppercase tracking-[1em] text-zinc-800 font-black italic">Premium Curation // Est. 2025</p>
    </footer>

    <!-- Settings Modal -->
    <div id="settings" class="fixed inset-0 z-[100] flex items-center justify-center bg-black/95 backdrop-blur-2xl hidden p-4">
        <div class="bg-zinc-900/80 p-8 md:p-12 border border-white/10 max-w-lg w-full rounded-2xl shadow-2xl">
            <h3 class="accent-font text-2xl md:text-3xl font-black mb-8 text-white text-center md:text-left">Параметры Ядра</h3>
            <label class="block text-[10px] uppercase tracking-widest text-zinc-500 mb-4">Подпись Ассистента</label>
            <input type="text" id="asst-name" value="The Architect" class="w-full bg-white/5 border border-white/10 p-5 outline-none focus:border-amber-500 mb-10 text-xl text-white font-bold rounded-lg">
            <div class="flex flex-col sm:flex-row gap-4">
                <button onclick="saveSettings()" class="flex-1 py-5 bg-amber-600 font-black uppercase text-[11px] tracking-[0.3em] hover:bg-amber-500 transition-all rounded-lg">Обновить</button>
                <button onclick="toggleSettings()" class="sm:px-8 py-5 border border-white/10 text-[11px] font-bold uppercase tracking-widest hover:bg-white/5 transition-all rounded-lg">Закрыть</button>
            </div>
        </div>
    </div>

    <script>
        const apiKey = "AIzaSyBFM4gPajzm9BjClnc5cDfcdX4HQT7paqM";
        let currentStyle = 'pro';
        let assistantName = "The Architect";
        let isTransitioning = false;
        let currentFilter = 'all';
        let searchQuery = '';

        const AI_DATA = [
            { name: "Runway Gen-3", cat: "video", url: "https://runwayml.com", desc: "Профессиональное видео с полной физикой." },
            { name: "Luma Dream Machine", cat: "video", url: "https://lumalabs.ai", desc: "Фотореалистичная анимация из статики." },
            { name: "Flux.1 [Pro]", cat: "image", url: "https://blackforestlabs.ai", desc: "Эталон визуализации и рендеринга текста." },
            { name: "Midjourney v6", cat: "image", url: "https://midjourney.com", desc: "Золотой стандарт ИИ-эстетики." },
            { name: "Claude 3.5 Sonnet", cat: "llm", url: "https://claude.ai", desc: "Интеллект для кода и сложных логик." },
            { name: "ChatGPT (GPT-4o)", cat: "llm", url: "https://chatgpt.com", desc: "Универсальный стандарт помощника." },
            { name: "ElevenLabs", cat: "audio", url: "https://elevenlabs.io", desc: "Синтез речи премиального уровня." },
            { name: "Suno v3.5", cat: "audio", url: "https://suno.com", desc: "Музыкальные шедевры из одного промпта." },
            { name: "Cursor", cat: "code", url: "https://cursor.com", desc: "Среда разработки с глубокой интеграцией ИИ." },
            { name: "Magnific AI", cat: "image", url: "https://magnific.ai", desc: "Экстремальная детализация и апскейл." }
        ];

        // --- ДИНАМИЧЕСКИЙ ГУСТОЙ КУРСОР ---
        const cursorMain = document.getElementById('cursor-main');
        const cursorTrail = document.getElementById('cursor-trail');
        const cursorDot = document.getElementById('cursor-dot');
        
        let mouseX = 0, mouseY = 0;
        let mainX = 0, mainY = 0;
        let trailX = 0, trailY = 0;
        let speed = 0.18;

        document.addEventListener('mousemove', (e) => {
            mouseX = e.clientX; mouseY = e.clientY;
            cursorDot.style.left = mouseX + 'px';
            cursorDot.style.top = mouseY + 'px';
        });

        function animateCursor() {
            let dxMain = mouseX - mainX;
            let dyMain = mouseY - mainY;
            mainX += dxMain * speed;
            mainY += dyMain * speed;

            let dxTrail = mainX - trailX;
            let dyTrail = mainY - trailY;
            trailX += dxTrail * 0.12;
            trailY += dyTrail * 0.12;

            let velocity = Math.sqrt(dxMain*dxMain + dyMain*dyMain);
            let stretch = 1 + (velocity / 80);
            let squeeze = 1 - (velocity / 160);
            let angle = Math.atan2(dyMain, dxMain) * 180 / Math.PI;

            cursorMain.style.transform = `translate(${mainX - 21}px, ${mainY - 21}px) rotate(${angle}deg) scale(${stretch}, ${squeeze})`;
            cursorTrail.style.transform = `translate(${trailX - 17}px, ${trailY - 17}px) scale(${stretch * 0.9})`;

            requestAnimationFrame(animateCursor);
        }
        animateCursor();

        // --- MAGNETIC EFFECT ---
        document.addEventListener('mousemove', (e) => {
            const magnetics = document.querySelectorAll('.magnetic');
            magnetics.forEach(el => {
                const rect = el.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                const dist = Math.sqrt(Math.pow(e.clientX - centerX, 2) + Math.pow(e.clientY - centerY, 2));
                
                if (dist < 150) {
                    const power = (150 - dist) / 150;
                    el.style.transform = `translate(${(e.clientX - centerX) * 0.45 * power}px, ${(e.clientY - centerY) * 0.45 * power}px)`;
                } else {
                    el.style.transform = `translate(0,0)`;
                }
            });
        });

        // --- STYLE SWITCHER ---
        function changeStyle(style) {
            if (isTransitioning || style === currentStyle) return;
            isTransitioning = true;
            const shutter = document.getElementById('shutter');
            shutter.classList.add('shutter-anim');

            setTimeout(() => {
                currentStyle = style;
                document.body.className = `style-${style} antialiased`;
                document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.toggle('active', btn.id === `btn-${style}`));
                
                updateNavBg();

                const titles = { pro: "The Core.", picasso: "Fragmented.", vangogh: "Turbulent.", whiskey: "Reserve." };
                document.getElementById('hero-title').innerText = titles[style];
                
                renderGallery();
                initParticles();
            }, 600);

            setTimeout(() => { shutter.classList.remove('shutter-anim'); isTransitioning = false; }, 1200);
        }

        function updateNavBg() {
            const activeBtn = document.querySelector('.nav-btn.active');
            const liquidBg = document.getElementById('liquid-bg');
            if(activeBtn && liquidBg) {
                liquidBg.style.width = activeBtn.offsetWidth + 'px';
                liquidBg.style.left = activeBtn.offsetLeft + 'px';
            }
        }

        async function runAdvisor() {
            const query = document.getElementById('advisor-query').value;
            if(!query) return;

            const btn = document.getElementById('advisor-btn');
            const resultBox = document.getElementById('advisor-content');
            const empty = document.getElementById('advisor-empty');
            
            btn.disabled = true;
            btn.innerText = "Формирование резонанса...";
            empty.classList.add('hidden');
            resultBox.classList.remove('hidden');
            resultBox.innerHTML = `<div class="animate-pulse space-y-10"><div class="h-2 bg-amber-500/20 w-full rounded"></div><div class="h-64 bg-white/5 rounded-3xl"></div></div>`;

            const styleContext = {
                pro: "Деловой, футуристичный, архитектурный.",
                picasso: "Абстрактный, кубистический, радикальный.",
                vangogh: "Экспрессивный, художественный, эмоциональный.",
                whiskey: "Аристократичный, выдержанный, премиальный."
            };

            const systemPrompt = `Ты - ${assistantName}. Твой стиль: ${styleContext[currentStyle]}. Спроектируй решение на русском языке. Ответ в JSON: { "title": "...", "steps": [{"tool": "...", "desc": "..."}], "prompt": "Английский промпт", "alternative": { "name": "...", "reason": "..." } }`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: query }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] },
                        generationConfig: { responseMimeType: "application/json" }
                    })
                });
                const data = await response.json();
                const res = JSON.parse(data.candidates[0].content.parts[0].text);

                resultBox.innerHTML = `
                    <div class="animate-in fade-in slide-in-from-bottom-12 duration-1000">
                        <h4 class="accent-font text-3xl md:text-4xl font-black mb-10 italic text-amber-500">${res.title}</h4>
                        <div class="space-y-6">
                            ${res.steps.map(s => `
                                <div class="p-8 bg-white/5 border-l-4 border-amber-500 rounded-r-2xl">
                                    <div class="text-[9px] font-black uppercase text-zinc-500 mb-2 tracking-[0.4em]">${s.tool}</div>
                                    <div class="text-lg font-medium leading-relaxed">${s.desc}</div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="mt-12 p-10 bg-amber-500/5 border border-amber-500/10 rounded-3xl">
                            <div class="text-2xl font-bold mb-3">${res.alternative.name}</div>
                            <div class="text-sm text-zinc-400 italic leading-relaxed">${res.alternative.reason}</div>
                        </div>
                        <div class="mt-12 relative">
                            <button onclick="copyPrompt(\`${res.prompt}\`)" class="absolute top-6 right-6 text-[9px] font-black uppercase text-amber-500 hover:text-white transition-all bg-black/40 px-4 py-2 rounded-lg">Копировать</button>
                            <pre class="bg-black/60 p-10 text-[12px] font-mono text-amber-500/70 border border-white/5 overflow-x-auto rounded-3xl whitespace-pre-wrap leading-relaxed">${res.prompt}</pre>
                        </div>
                    </div>
                `;
            } catch (err) {
                resultBox.innerHTML = `<p class="text-red-500 font-bold text-center">Ошибка инициализации ядра.</p>`;
            } finally { btn.disabled = false; btn.innerText = "Создать Стратегию"; }
        }

        function renderGallery() {
            const container = document.getElementById('grid-container');
            container.innerHTML = '';
            const filtered = AI_DATA.filter(item => {
                const matchesFilter = currentFilter === 'all' || item.cat === currentFilter;
                const matchesSearch = item.name.toLowerCase().includes(searchQuery);
                return matchesFilter && matchesSearch;
            });
            filtered.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'model-card p-10 reveal active h-full';
                card.style.transitionDelay = `${(index % 12) * 50}ms`;
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-10">
                        <span class="text-[9px] font-black uppercase tracking-[0.3em] text-amber-500 border border-amber-500/20 px-3 py-1.5">${item.cat}</span>
                    </div>
                    <h4 class="accent-font text-2xl font-black mb-6 tracking-tighter text-white">${item.name}</h4>
                    <p class="text-[13px] text-zinc-500 leading-relaxed mb-12 line-clamp-3">${item.desc}</p>
                    <div class="pt-8 border-t border-white/5 mt-auto">
                        <a href="${item.url}" target="_blank" class="text-[10px] font-black uppercase tracking-[0.2em] hover:text-amber-500 transition-all flex items-center gap-2">Открыть Протокол <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7-7 7M5 12h16"/></svg></a>
                    </div>
                `;
                container.appendChild(card);
            });
            document.getElementById('tool-counter').innerText = `Синхронизировано: ${filtered.length} моделей`;
        }

        function setFilter(cat) {
            currentFilter = cat;
            document.querySelectorAll('#filter-bar span').forEach(el => el.classList.toggle('active-filter', el.getAttribute('data-cat') === cat));
            renderGallery();
        }

        function handleSearch() { searchQuery = document.getElementById('search-input').value.toLowerCase(); renderGallery(); }
        function copyPrompt(text) {
            const temp = document.createElement("textarea"); temp.value = text;
            document.body.appendChild(temp); temp.select(); document.execCommand("copy");
            document.body.removeChild(temp);
            const toast = document.getElementById('toast'); toast.style.display = 'block';
            setTimeout(() => toast.style.display = 'none', 2000);
        }
        function toggleSettings() { document.getElementById('settings').classList.toggle('hidden'); }
        function saveSettings() { assistantName = document.getElementById('asst-name').value || "The Architect"; document.getElementById('display-asst-name').innerText = assistantName; toggleSettings(); }

        let particles = [];
        let animationId;
        function initParticles() {
            if(animationId) cancelAnimationFrame(animationId);
            const canvas = document.getElementById('bg-canvas');
            const ctx = canvas.getContext('2d');
            particles = [];
            function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
            window.addEventListener('resize', resize); resize();

            class Particle {
                constructor() { this.reset(); }
                reset() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.size = Math.random() * (currentStyle === 'pro' ? 200 : 600) + 150;
                    this.speedX = (Math.random() - 0.5) * 0.4;
                    this.speedY = (Math.random() - 0.5) * 0.4;
                    this.alpha = Math.random() * 0.1 + 0.02;
                    this.color = currentStyle === 'pro' ? '200, 200, 200' : currentStyle === 'picasso' ? '217, 119, 6' : currentStyle === 'vangogh' ? '250, 204, 21' : '245, 158, 11';
                }
                update() {
                    this.x += this.speedX; this.y += this.speedY;
                    if(this.x < -this.size || this.x > canvas.width + this.size) this.reset();
                    if(this.y < -this.size || this.y > canvas.height + this.size) this.reset();
                }
                draw() {
                    ctx.beginPath();
                    let g = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size);
                    g.addColorStop(0, `rgba(${this.color}, ${this.alpha})`);
                    g.addColorStop(1, `rgba(${this.color}, 0)`);
                    ctx.fillStyle = g;
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill();
                }
            }
            for(let i=0; i<35; i++) particles.push(new Particle());
            function animate() {
                ctx.clearRect(0,0, canvas.width, canvas.height);
                particles.forEach(p => { p.update(); p.draw(); });
                animationId = requestAnimationFrame(animate);
            }
            animate();
        }

        window.onload = () => { renderGallery(); initParticles(); updateNavBg();
            const obs = new IntersectionObserver((entries) => {
                entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('active'); });
            }, { threshold: 0.1 });
            document.querySelectorAll('.reveal').forEach(el => obs.observe(el));
        };
    </script>
</body>
</html>
